package org.openape.server.auth;

import org.openape.api.Resource;
import org.openape.api.user.User;

import spark.Request;
import spark.Response;

/**
 * This class is the authentication service for resources. It checks if the logged in user is allowed to do an action
 * with an resource or not. Therefore it checks, whether the logged in user is an OpenAPE admin, the owner of the resource or a
 * member of a group, which has the needed right.
 * 
 * @author Tobias Ableitner
 *
 */
public class ResourceAuthService extends AuthService {

	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// attributes
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************

	private static final String ADMIN_ROLE = "admin";



	
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// constructors
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************




	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// getters and setters
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************

	


	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// abstract methods
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************

	
	

	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// override methods
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************




	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// public methods
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************

	public void allowReading(Request request, Response response, Resource resource) throws UnauthorizedException{
		// TODO implement
		User user = this.getAuthenticatedUser(request, response);
		if(user.getRoles().contains(ADMIN_ROLE)){
			return;
		}
		if(resource.getOwner().equals(user.getId())){
			return;
		}
		throw new UnauthorizedException("You are not allowed to perform this operation");
	}
	
	public void allowUpdating(Request request, Response response, Resource resource) throws UnauthorizedException{
		// TODO implement
	}
	
	public void allowDeleting(Request request, Response response, Resource resource) throws UnauthorizedException{
		// TODO implement
	}
	
	public void allowRightsChanging(Request request, Response response, Resource resource) throws UnauthorizedException{
		// TODO implement
	}

	
	
	
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// protected methods
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************




	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// private methods
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************




	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************
	// inner classes
	// *********************************************************************************************************************************************
	// *********************************************************************************************************************************************

}
