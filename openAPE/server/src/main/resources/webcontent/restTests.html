<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>openAPE</title>
    <script type="application/javascript">
        var serveraddress = "http://localhost:8080/openape/";
		var sampleUserContext = '{"contexts":{"default":{"name":"Default preferences","preferences":{"http://registry.gpii.net/common/magnifierEnabled":"false","http://registry.gpii.net/applications/org.chrome.cloud4chrome/invertColours":"false"}},"dark":{"conditions":[{"type":"and","operands":[{"type":"ge","operands":["http://registry.gpii.net/common/env/visual.luminance","0"]},{"type":"le","operands":["http://registry.gpii.net/common/env/visual.luminance","200"]}]}],"name":"little environmental light","preferences":{"http://registry.gpii.net/common/magnifierEnabled":"true","http://registry.gpii.net/common/magnification":"2"}}}}';
		var id;
		
		function loadPage() {
			document.getElementById("dataInput").value = sampleUserContext;
		}
		
        function saveData() {
			var data = document.getElementById("dataInput").value;
        	var selectedAddress = document.querySelector('input[name="dataType"]:checked').value;
            var req = new XMLHttpRequest();
            req.open("POST", serveraddress + selectedAddress, true);
            req.setRequestHeader("Content-Type", "application/json");
            req.send(data);
            req.onreadystatechange = function () {
                if (req.readyState == 4) {
					document.getElementById("saveStatus").value = req.status;
					console.log(req.response);
					if (req.status === 201) {
						id = req.response;
					}
                }
            }
        }
		
		function loadData() {
        	var selectedAddress = document.querySelector('input[name="dataType"]:checked').value;
            var req = new XMLHttpRequest();
            req.open("GET", serveraddress + selectedAddress + "/" + id, true);
            req.send();
            req.onreadystatechange = function () {
                if (req.readyState == 4) {
					document.getElementById("loadStatus").value = req.status;
					console.log(req.response);
                }
            }
        }
		
		function updateData() {
			var data = document.getElementById("dataInput").value;
        	var selectedAddress = document.querySelector('input[name="dataType"]:checked').value;
            var req = new XMLHttpRequest();
            req.open("PUT", serveraddress + selectedAddress + "/" + id, true);
            req.setRequestHeader("Content-Type", "application/json");
            req.send(data);
            req.onreadystatechange = function () {
                if (req.readyState == 4) {
					document.getElementById("updateStatus").value = req.status;
					console.log(req.response);
                }
            }
        }
		
		function deleteData() {
        	var selectedAddress = document.querySelector('input[name="dataType"]:checked').value;
            var req = new XMLHttpRequest();
            req.open("DELETE", serveraddress + selectedAddress + "/" + id, true);
            req.send();
            req.onreadystatechange = function () {
                if (req.readyState == 4) {
					document.getElementById("deleteStatus").value = req.status;
					console.log(req.response);
                }
            }
        }

		
		function loadRes() {
            var req = new XMLHttpRequest();
            var resourceName = document.getElementById("resourceName").value;
            req.open("GET", serveraddress + "api/resources" + "/" + resourceName, true);
            req.send();
            req.onreadystatechange = function () {
                if (req.readyState == 4) {
					document.getElementById("resLoadStatus").value = req.status;
					console.log(req.response);
                }
            }
        }
		
		function deleteRes() {
            var req = new XMLHttpRequest();
            var resourceName = document.getElementById("resourceName").value;
            req.open("DELETE", serveraddress + "api/resources" + "/" + resourceName, true);
            req.send();
            req.onreadystatechange = function () {
                if (req.readyState == 4) {
					document.getElementById("resDeleteStatus").value = req.status;
					console.log(req.response);
                }
            }
        }

</script>
</head>
<body onload="loadPage()">
<h2 style="text-align: center;">Data storage</h2>
<div style="width: 10em; margin: 0px auto 0px auto;">
<input type="radio" id="EnC" name="dataType" value="api/environment-contexts"> <label for="EnC"> environment context</label><br> 
<input type="radio" id="EqC" name="dataType" value="api/equipment-contexts"> <label for="EqC"> equipment context</label><br> 
<input type="radio" id="TC" name="dataType" value="api/task-contexts"> <label for="TC"> task context</label><br>
<input type="radio" id="UC" name="dataType" value="api/user-contexts" checked="checked"> <label for="UC"> user context</label><br>
<input type="radio" id="RD" name="dataType" value="api/resource-descriptions"> <label for="RD"> resource description</label><br>
<input type="radio" id="L" name="dataType" value="api/listings"> <label for="L"> listing</label><br>
</div><br>
<div style="text-align: center;">
<textarea id="dataInput" name="dataInput" cols="100" rows="8"></textarea> <br>
</div><br>
<table style="margin-left:auto; margin-right:auto;">
	<tr>
		<td><button type="button" id="saveData" onclick="saveData()">store data</button></td>
		<td><label>Status:<input type="text" id="saveStatus"/></label></td>
	</tr>
	<tr>
		<td><button type="button" id="loadData" onclick="loadData()">load data</button></td>
		<td><label>Status:<input type="text" id="loadStatus"/></label></td>
	</tr>
	<tr>
		<td><button type="button" id="updateData" onclick="updateData()">update data</button></td>
		<td><label>Status:<input type="text" id="updateStatus"/></label></td>
	</tr>
	<tr>
		<td><button type="button" id="deleteData" onclick="deleteData()">delete data</button></td>
		<td><label>Status:<input type="text" id="deleteStatus"/></label></td>
	</tr>
</table><br>
<div style="text-align: center;">
<h2>Resource Storage</h2>
<form action="http://localhost:8080/openape/api/resources" method="post" enctype="multipart/form-data">
	<input name="file" id="filename" type="file" />
	<button name="submit" type="submit">store resource</button>
</form>
<label>resource name: <input type="text" id="resourceName"/></label><br>
</div><br>
<table style="margin-left:auto; margin-right:auto;">
	<tr>
		<td><button type="button" id="loadRes" onclick="loadRes()">load resource</button></td>
		<td><label>Status:<input type="text" id="resLoadStatus"/></label></td>
	</tr>
	<tr>
		<td><button type="button" id="deleteRes" onclick="deleteRes()">delete resource</button></td>
		<td><label>Status:<input type="text" id="resDeleteStatus"/></label></td>
	</tr>
</table>
</body>
</html>